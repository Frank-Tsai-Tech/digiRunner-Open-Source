"use strict";(self.webpackChunksrcAngular=self.webpackChunksrcAngular||[]).push([[3961],{13961:(_t,y,a)=>{a.r(y),a.d(y,{Np0202Module:()=>dt});var m=a(69808),T=a(78555),b=a(31890),r=a(93075),C=a(86347),g=a(99291),u=a(15861),v=a(14525),_=a(57553),N=a(78165),A=a(17445),I=a(63900),Z=a(18505),t=a(87587),E=a(56435),L=a(45682),R=a(41454),w=a(62805),B=a(63710),x=a(33725),S=a(23099),J=a(59783),U=a(40845),D=a(4119),k=a(41792),Q=a(5437),Y=a(86561),F=a(17773),H=a(51062);const M=["dialog"],P=["error_messages"];function O(n,s){1&n&&t._UZ(0,"col"),2&n&&t.Udp("width",s.$implicit.width)}function q(n,s){if(1&n&&(t.TgZ(0,"colgroup"),t.YNc(1,O,1,2,"col",22),t.qZA()),2&n){const e=s.$implicit;t.xp6(1),t.Q6J("ngForOf",e)}}function G(n,s){if(1&n&&(t.TgZ(0,"th",25),t._uU(1),t.qZA()),2&n){const e=s.$implicit;t.xp6(1),t.hij(" ",e.header," ")}}function j(n,s){if(1&n&&(t.TgZ(0,"tr"),t.YNc(1,G,2,1,"th",23),t.TgZ(2,"th",24),t._uU(3),t.ALo(4,"translate"),t.qZA()()),2&n){const e=s.$implicit;t.xp6(1),t.Q6J("ngForOf",e),t.xp6(2),t.hij("",t.lcZ(4,2,"action")," ")}}function z(n,s){if(1&n&&(t.TgZ(0,"td")(1,"span"),t._uU(2),t.qZA()()),2&n){const e=s.$implicit,o=t.oxw().$implicit;t.Udp("width",e.width),t.xp6(2),t.hij(" ",o[e.field]," ")}}function W(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"tr"),t.YNc(1,z,3,3,"td",22),t.TgZ(2,"td",26)(3,"button",27),t.NdJ("click",function(){const c=t.CHM(e).$implicit,l=t.oxw(3);return l.showDialog(c,l.formOperate.detail)}),t.ALo(4,"translate"),t.qZA()()()}if(2&n){const e=s.columns;t.xp6(1),t.Q6J("ngForOf",e),t.xp6(2),t.Q6J("pTooltip",t.lcZ(4,2,"button.detail"))}}function X(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td",28)(2,"span",29),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",30),t.NdJ("click",function(){return t.CHM(e),t.oxw(4).moreData()}),t._uU(6),t.ALo(7,"translate"),t._UZ(8,"i",31),t.qZA()()()}if(2&n){const e=t.oxw().$implicit,o=t.oxw(3);t.xp6(1),t.uIk("colspan",e.length+1),t.xp6(2),t.AsE("",t.lcZ(4,4,"row_count"),": ",o.rowcount,""),t.xp6(3),t.hij("",t.lcZ(7,6,"button.more")," ")}}function V(n,s){if(1&n&&t.YNc(0,X,9,8,"tr",1),2&n){const e=t.oxw(3);t.Q6J("ngIf",e.rowcount)}}function K(n,s){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n){const e=s.$implicit;t.xp6(1),t.uIk("colspan",e.length+1),t.xp6(1),t.hij(" ",t.lcZ(3,2,"no_rec")," ")}}const tt=function(){return{"word-break":"break-word"}};function et(n,s){if(1&n&&(t.TgZ(0,"p-table",16),t.YNc(1,q,2,1,"ng-template",17),t.YNc(2,j,5,4,"ng-template",18),t.YNc(3,W,5,4,"ng-template",19),t.YNc(4,V,1,1,"ng-template",20),t.YNc(5,K,4,4,"ng-template",21),t.qZA()),2&n){const e=t.oxw(2);t.Akn(t.DdM(4,tt)),t.Q6J("columns",e.cols)("value",e.dataList)}}function nt(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"p-tabPanel",7),t.ALo(1,"translate"),t.ALo(2,"translate"),t.TgZ(3,"div",8)(4,"div",9)(5,"label",32),t._uU(6),t.ALo(7,"translate"),t.ALo(8,"translate"),t.qZA(),t._UZ(9,"input",33),t.qZA()(),t.TgZ(10,"div",8)(11,"div",34)(12,"button",13),t._uU(13),t.ALo(14,"translate"),t.qZA()()(),t._UZ(15,"hr")(16,"app-ca-card",35),t.TgZ(17,"app-ca-stat",36),t.NdJ("restart",function(i){return t.CHM(e),t.oxw(2).restart(i)}),t.qZA()()}if(2&n){const e=t.oxw(2);t.hYB("header","",t.lcZ(1,12,"message.interface"),"",t.lcZ(2,14,"button.search"),""),t.xp6(6),t.AsE("",t.lcZ(7,16,"message.interface"),"",t.lcZ(8,18,"button.search"),""),t.xp6(3),t.Q6J("placeholder",e.placeholder),t.xp6(4),t.Oqu(t.lcZ(14,20,"button.search")),t.xp6(3),t.Q6J("cards",e.cards),t.xp6(1),t.Q6J("showType",!1)("apptJobId",e.apptJobId)("stackTrace",e.stackTrace)("statusName",e.statusName)("cgRespBody",e.cgRespBody)}}function ot(n,s){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",5),t.NdJ("ngSubmit",function(){return t.CHM(e),t.oxw().submitForm()}),t.TgZ(2,"p-tabView",6),t.NdJ("activeIndexChange",function(i){return t.CHM(e),t.oxw().activeIndex=i}),t.TgZ(3,"p-tabPanel",7),t.ALo(4,"translate"),t.TgZ(5,"div",8)(6,"div",9)(7,"label",10),t._uU(8),t.ALo(9,"translate"),t.qZA(),t._UZ(10,"input",11),t.ALo(11,"translate"),t.qZA()(),t.TgZ(12,"div",8)(13,"div",12)(14,"button",13),t._uU(15),t.ALo(16,"translate"),t.qZA()()(),t._UZ(17,"hr"),t.YNc(18,et,6,5,"p-table",14),t.qZA(),t.YNc(19,nt,18,22,"p-tabPanel",15),t.qZA()(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(1),t.Q6J("activeIndex",e.activeIndex),t.xp6(1),t.s9C("header",t.lcZ(4,8,"client_search")),t.xp6(5),t.Oqu(t.lcZ(9,10,"client_search")),t.xp6(2),t.s9C("placeholder",t.lcZ(11,12,"fuzzy_search")),t.xp6(5),t.Oqu(t.lcZ(16,14,"button.search")),t.xp6(3),t.Q6J("ngIf",e.cols),t.xp6(1),t.Q6J("ngIf","Y"===e.isCusEnable)}}function it(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"app-client-ca",40),t.NdJ("rowDataHandler",function(i){return t.CHM(e),t.oxw(2).rowDataHandler(i)}),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("data",e.clientData)("isCusEnable",e.isCusEnable)}}function at(n,s){if(1&n){const e=t.EpF();t.ynx(0),t.YNc(1,it,1,2,"app-client-ca",37),t.TgZ(2,"div",38)(3,"button",39),t.NdJ("click",function(i){return t.CHM(e),t.oxw().redirectList(i)}),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.clientData),t.xp6(3),t.Oqu(t.lcZ(5,2,"button.return_to_list"))}}function st(n,s){if(1&n&&t._UZ(0,"app-ca-detail",42),2&n){const e=t.oxw(2);t.Q6J("data",e.caData)("center",!1)}}function ct(n,s){if(1&n){const e=t.EpF();t.ynx(0),t.YNc(1,st,1,2,"app-ca-detail",41),t.TgZ(2,"div",38)(3,"button",39),t.NdJ("click",function(i){return t.CHM(e),t.oxw().redirectPrev(i)}),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.caData),t.xp6(3),t.Oqu(t.lcZ(5,2,"button.return"))}}const rt=function(){return{marginTop:"60px"}};let lt=(()=>{class n extends v.H{constructor(e,o,i,c,l,h,f){super(e,o),this.fb=i,this.tool=c,this.clientCA=l,this.clientService=h,this.cusService=f,this.formOperate=_.mi,this.cols=[],this.rowcount=0,this.dialogTitle="",this.dataList=new Array,this.colETB=[],this.activeIndex=d.CLIENT_SEARCH,this.emPageBlock=p,this.pageNum=p.QUERYPAGE,this.cusTitle=[],this.isCusEnable="N",this.placeholder="",this.apptJobId=0,this.stackTrace="",this.cgRespBody="",this.form=this.fb.group({keyword:new r.NI(""),interface_keyword:new r.NI("")})}ngOnInit(){var e=this;return(0,u.Z)(function*(){e.init();const i=yield e.tool.getDict(["message.client","button.search","button.detail","cert_detail","client_cert_list"]);e.cusTitle=[e.title,`${e.title} > ${i.client_cert_list}`,`${e.title} > ${i.client_cert_list} > ${i.cert_detail}`],e.otherSettings().then()})()}otherSettings(){var e=this;return(0,u.Z)(function*(){e.clientCA.queryCusEnable().subscribe(function(){var o=(0,u.Z)(function*(i){e.isCusEnable=i.RespBody.isCusEnable,"Y"===e.isCusEnable&&e.clientCA.queryCusUrl().subscribe(c=>{e.cusService.basePath=c.RespBody.cusUrl;const l=e.tool.Base64Encoder(e.tool.BcryptEncoder("MSG")),h=e.tool.Base64Encoder(e.tool.BcryptEncoder("SEARCH_WORD"));e.cusService.querySettings({settingNo:l+",2",subsettingNo:h+",0",isDefault:"N"}).subscribe(f=>e.placeholder=f.RespBody.cus0001Items[0].param1)})});return function(i){return o.apply(this,arguments)}}())})()}init(){var e=this;return(0,u.Z)(function*(){const i=yield e.tool.getDict(["client_id","client_name","client_alias"]);e.cols=[{field:"clientId",header:i.client_id},{field:"clientName",header:i.client_name},{field:"clientAlias",header:i.client_alias}],e.dataList=[],e.rowcount=e.dataList.length,e.clientService.queryClientListByLike_ignore1298({keyword:e.keyword.value}).subscribe(l=>{e.tool.checkDpSuccess(l.ResHeader)&&(e.dataList=l.RespBody.dataList,e.rowcount=e.dataList.length)}),e.colETB=[{field:"tspId",header:"TSP ID"},{field:"dy",header:"\u52d5\u614b\u5c55\u958b..."}]})()}submitForm(){switch(this.activeIndex){case d.CLIENT_SEARCH:this.clientSubmitForm();break;case d.INTERFACE_SEARCH:this.interfaceSubmitForm()}}clientSubmitForm(){this.dataList=[],this.rowcount=this.dataList.length,this.clientService.queryClientListByLike({keyword:this.keyword.value}).subscribe(o=>{this.tool.checkDpSuccess(o.ResHeader)&&(this.dataList=o.RespBody.dataList,this.rowcount=this.dataList.length)})}interfaceSubmitForm(){this.cusService.queryQmInvokeCUS0003({tspid:this.interface_keyword.value}).subscribe(i=>{i.RespBody.apptJobId?(this.apptJobId=i.RespBody.apptJobId,this.statusName="\u8655\u7406\u4e2d...",this.loopStatusCUS0003()):i.RespBody.showUI&&i.RespBody.showUI.cgRespBody&&(this.cards=i.RespBody.showUI.cgRespBody.data)})}loopStatusCUS0003(){var e=this;this.intervalSubscription=(0,A.F)(1e3).pipe((0,I.w)(()=>this.cusService.queryQmLoopStatusCUS0003({apptJobId:this.apptJobId}))).subscribe(function(){var o=(0,u.Z)(function*(i){[_.vp.\u5b8c\u6210,_.vp.\u5931\u6557,_.vp.\u53d6\u6d88].includes(i.RespBody.commLoopStatus.status)&&(e.stop(),i.RespBody.commLoopStatus.status===_.vp.\u5b8c\u6210&&(yield e.resultCUS0003().toPromise())),e.stackTrace=i.RespBody.commLoopStatus.stackTrace,e.statusName=i.RespBody.commLoopStatus.statusName});return function(i){return o.apply(this,arguments)}}())}resultCUS0003(){return this.cusService.queryQmResultCUS0003({apptJobId:this.apptJobId}).pipe((0,Z.b)(e=>{this.statusName=e.RespBody.result.commLoopStatus.statusName,this.cgRespBody=JSON.stringify(e.RespBody.result.showUI.cgRespBody),this.stackTrace=e.RespBody.result.commLoopStatus.stackTrace,e.RespBody.result.showUI&&e.RespBody.result.showUI.cgRespBody&&(this.cards=e.RespBody.result.showUI.cgRespBody.data)}))}stop(){this.intervalSubscription&&this.intervalSubscription.unsubscribe()}redirectPrev(){this.pageNum=this.emPageBlock.CLIENT_DETAIL,this.title=this.cusTitle[this.pageNum]}redirectList(){this.pageNum=this.emPageBlock.QUERYPAGE,this.title=this.cusTitle[this.pageNum]}showDialog(e){var o=this;return(0,u.Z)(function*(){let i={clientId:e.clientId,encodeCertType:o.tool.Base64Encoder(o.tool.BcryptEncoder("JWE"))+",0"};o.pageNum=o.emPageBlock.CLIENT_DETAIL,o.title=o.cusTitle[o.pageNum],o.clientData={data:{type:"JWE",clientId:e.clientId,rowData:e,ReqBody:i},displayInDialog:!0}})()}rowDataHandler(e){this.pageNum=this.emPageBlock.CA_DETAIL,this.title=this.cusTitle[this.pageNum],this.caData=e}moreData(){this.clientService.queryClientListByLike({clientId:this.dataList[this.dataList.length-1].clientId,keyword:this.keyword.value}).subscribe(o=>{this.tool.checkDpSuccess(o.ResHeader)&&(this.dataList=this.dataList.concat(o.RespBody.dataList),this.rowcount=this.dataList.length)})}restart(e){this.stackTrace="",this.cgRespBody="",this.resultCUS0003().subscribe()}switchErrorMessage(e){$(this.error_messages.nativeElement).toggleClass("hide")}headerReturn(){this.pageNum===p.CLIENT_DETAIL?this.redirectList():this.pageNum===p.CA_DETAIL&&this.redirectPrev()}get keyword(){return this.form.get("keyword")}get interface_keyword(){return this.form.get("interface_keyword")}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g.gz),t.Y36(E.W),t.Y36(r.qu),t.Y36(L.g),t.Y36(R.p),t.Y36(N.y),t.Y36(w.V))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-np0202"]],viewQuery:function(e,o){if(1&e&&(t.Gf(M,5),t.Gf(P,5)),2&e){let i;t.iGM(i=t.CRH())&&(o._dialog=i.first),t.iGM(i=t.CRH())&&(o.error_messages=i.first)}},features:[t._Bn([N.y]),t.qOj],decls:7,vars:9,consts:[[3,"title","isDefault","headerReturn"],[4,"ngIf"],[3,"title"],["dialog",""],["position","top-left"],[3,"formGroup","ngSubmit"],[3,"activeIndex","activeIndexChange"],[3,"header"],[1,"form-group","row"],[1,"col-4","col-xl-4","col-lg-4"],["for","keyword",1,"control-label"],["type","text","id","keyword","formControlName","keyword",1,"form-control",3,"placeholder"],[1,"col-3","col-xl-3","col-lg-3"],["type","submit",1,"btn","tpi-btn","tpi-primary","float-start","me-3"],["selectionMode","single","styleClass","p-datatable-striped",3,"columns","value","style",4,"ngIf"],[3,"header",4,"ngIf"],["selectionMode","single","styleClass","p-datatable-striped",3,"columns","value"],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["pTemplate","emptymessage"],[3,"width",4,"ngFor","ngForOf"],["scope","col",4,"ngFor","ngForOf"],["scope","col",2,"width","80px"],["scope","col"],[2,"text-align","center","width","80px"],["pButton","","pRipple","","type","button","icon","pi pi-eye","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-plain",3,"pTooltip","click"],[2,"color","#b7b7b7"],[2,"vertical-align","middle"],["type","button",1,"btn","tpi-header-return",3,"click"],[1,"fas","fa-angle-double-right",2,"margin-left","5px"],["for","keyword2",1,"control-label"],["type","text","id","keyword2","formControlName","interface_keyword",1,"form-control",3,"placeholder"],[1,"ms-3"],[3,"cards"],[3,"showType","apptJobId","stackTrace","statusName","cgRespBody","restart"],[3,"data","isCusEnable","rowDataHandler",4,"ngIf"],[1,"text-start"],["type","button",1,"btn","tpi-btn","tpi-primary",3,"click"],[3,"data","isCusEnable","rowDataHandler"],[3,"data","center",4,"ngIf"],[3,"data","center"]],template:function(e,o){1&e&&(t.TgZ(0,"app-container",0),t.NdJ("headerReturn",function(){return o.headerReturn()}),t.YNc(1,ot,20,16,"ng-container",1),t.YNc(2,at,6,4,"ng-container",1),t.YNc(3,ct,6,4,"ng-container",1),t.qZA(),t._UZ(4,"app-dialog",2,3)(6,"p-toast",4)),2&e&&(t.Q6J("title",o.title)("isDefault",o.pageNum==o.emPageBlock.QUERYPAGE),t.xp6(1),t.Q6J("ngIf",o.pageNum===o.emPageBlock.QUERYPAGE),t.xp6(1),t.Q6J("ngIf",o.pageNum===o.emPageBlock.CLIENT_DETAIL),t.xp6(1),t.Q6J("ngIf",o.pageNum===o.emPageBlock.CA_DETAIL),t.xp6(1),t.Q6J("title",o.dialogTitle),t.xp6(2),t.Akn(t.DdM(8,rt)))},directives:[B.e,m.O5,r._Y,r.JL,r.sg,x.xf,x.x4,r.Fj,r.JJ,r.u,S.iA,J.jx,m.sg,U.Hq,D.u,k.X,Q.D,Y.a,F.FN],pipes:[H.X$],styles:[".icon[_ngcontent-%COMP%]{cursor:pointer;font-size:larger}.error_messages[_ngcontent-%COMP%]{min-height:150px;background:#eee;opacity:1;transition:opacity .1s linear;padding:.5rem;border-radius:10px}.error_messages.hide[_ngcontent-%COMP%]{opacity:0;transition:opacity .1s linear}"]}),n})();var d=(()=>{return(n=d||(d={}))[n.CLIENT_SEARCH=0]="CLIENT_SEARCH",n[n.INTERFACE_SEARCH=1]="INTERFACE_SEARCH",d;var n})(),p=(()=>{return(n=p||(p={}))[n.QUERYPAGE=0]="QUERYPAGE",n[n.CLIENT_DETAIL=1]="CLIENT_DETAIL",n[n.CA_DETAIL=2]="CA_DETAIL",p;var n})();const pt=[{path:"",component:lt,canActivate:[C.u6]}];let ut=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[g.Bz.forChild(pt)],g.Bz]}),n})(),dt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[C.u6],imports:[[m.ez,ut,T.W,b.m,r.UX,r.u5]]}),n})()}}]);