(self.webpackChunksrcAngular=self.webpackChunksrcAngular||[]).push([[8592],{58838:(R,y,o)=>{"use strict";o.d(y,{n:()=>l});var f=o(27896),n=o(92340),c=o(57553),v=o(95244),a=o(87587),_=o(22313),t=o(4516),r=o(86518),e=o(69808);function i(h,P){if(1&h&&a._UZ(0,"iframe",1),2&h){const s=a.oxw();a.Q6J("src",s.url,a.uOi)}}const E=o(35117);let l=(()=>{class h{constructor(s,d,u,m){this.sanitizer=s,this.util=d,this.tool=u,this.alertService=m,this.reportID="",this.url="",this.timeRange=c.tn.Today,this.showStatus=!1,this.msgListenterAdd=!1,this.processing=!1,this.messageHandler=this.createMessageHandler()}ngOnInit(){this.showStatus=!1,this.url=this.sanitizer.bypassSecurityTrustResourceUrl(""),this.search(),window.addEventListener("message",this.messageHandler)}ngOnDestroy(){window.removeEventListener("message",this.messageHandler)}createMessageHandler(){return s=>{var d,u,m,p;"frame"==(null===(d=s.data)||void 0===d?void 0:d.from)&&"token_expired"==(null===(u=s.data)||void 0===u?void 0:u.type)?this.processing||(this.processing=!0,this.util.queryReportUrls({reportID:this.reportID.toUpperCase(),timeRange:"T"}).subscribe(A=>{var B;this.processing=!1,this.tool.checkDpSuccess(A.ResHeader)&&(null===(B=document.getElementById("_frame").contentWindow)||void 0===B||B.postMessage({from:"dgr",type:"redo"},"*"))})):"frame"==(null===(m=s.data)||void 0===m?void 0:m.from)&&"reset_idle_time"==(null===(p=s.data)||void 0===p?void 0:p.type)&&this.tool.setExpiredTime()}}search(s=!1){let d=this.generateCAPI();this.timeRange&&this.util.queryReportUrls({reportID:this.reportID.toUpperCase(),timeRange:"T"}).subscribe(u=>{if(this.tool.checkDpSuccess(u.ResHeader)){if(this.showStatus=!0,s)return;let m="";m="localhost"==location.hostname||"127.0.0.1"==location.hostname?n.N.apiUrl:`${location.protocol}//${location.hostname}:${location.port}`;let p="";switch(u.RespBody.reportType){case"SYS_RPT":p=`${m}${u.RespBody.rpContentPath}/login?cuuid=${d.uuid}&capikey=${d.capi}&reportURL=${u.RespBody.reportUrl}&embed=true`,this.url=this.sanitizer.bypassSecurityTrustResourceUrl(p);break;case"IFRAME":p=n.N.production?`${location.protocol}//${location.hostname}:${location.port}${u.RespBody.reportUrl}`:`${n.N.cusHostName}${u.RespBody.reportUrl}`,this.url=this.sanitizer.bypassSecurityTrustResourceUrl(p);break;case"LINK":p=`${u.RespBody.reportUrl}`,window.open(p,"_blank");break;default:this.alertService.ok("reportType not found","")}}})}generate_uuid(){var s=Date.now();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(s+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var u=(s+16*Math.random())%16|0;return s=Math.floor(s/16),("x"===d?u:3&u|8).toString(16)})}generateCAPI(){let s=this.generate_uuid().toUpperCase(),d=this.encodeUUID(s);return"Error: Digest method not supported"===d&&(s="67C42D24-BCFD-40B1-99E9-C4CE4D9ADBCD",d="tflvB2FW3nhUIvF3PMHQxw"),{uuid:s,capi:d}}encodeUUID(s){if("string"!=typeof s||0===s.length)return"";const u=Uint8Array.of(128),m=new TextEncoder;try{let p=s.toLocaleUpperCase()+"TPIdigiRunner",A=m.encode(p),B=this.concatenate(Uint8Array,A,u),D=v("sha256").update(B).digest(),x=D.subarray(D.length/2,D.length);return E(x)}catch(p){return console.log("e",p),p}}concatenate(s,...d){let u=0;for(const A of d)u+=A.length;const m=new s(u);let p=0;for(const A of d)m.set(A,p),p+=A.length;return m}}return h.\u0275fac=function(s){return new(s||h)(a.Y36(_.H7),a.Y36(f.f),a.Y36(t.g),a.Y36(r.c))},h.\u0275cmp=a.Xpm({type:h,selectors:[["app-frame"]],inputs:{reportID:"reportID"},features:[a._Bn([f.f])],decls:1,vars:1,consts:[["id","_frame","title","","width","100%","height","100%","frameborder","0",3,"src",4,"ngIf"],["id","_frame","title","","width","100%","height","100%","frameborder","0",3,"src"]],template:function(s,d){1&s&&a.YNc(0,i,1,1,"iframe",0),2&s&&a.Q6J("ngIf",d.showStatus)},directives:[e.O5],styles:[""]}),h})()},85118:(R,y,o)=>{"use strict";o.d(y,{U:()=>g});var f=o(92340),n=o(57553),c=o(87587),v=o(30424);let g=(()=>{class a{constructor(t){this.api=t}get npBasePath(){return f.N.isv4?"dgrv4/11":"tsmpdpaa/11"}addAlarmSettings_before(){let t={ReqHeader:this.api.getReqHeader(n.Nx.addAlarmSettings),ReqBody:{}};return this.api.npPost(`${this.npBasePath}/AA0701?before`,t)}addAlarmSettings(t){let r={ReqHeader:this.api.getReqHeader(n.Nx.addAlarmSettings),ReqBody:t};return this.api.npPost(`${this.npBasePath}/AA0701`,r)}queryAlertSettingDetail(t){let r={ReqHeader:this.api.getReqHeader(n.Nx.queryAlertSettingDetail),ReqBody:t};return this.api.npPost(`${this.npBasePath}/AA0703`,r)}updateAlertSetting_before(){let t={ReqHeader:this.api.getReqHeader(n.Nx.updateAlertSetting),ReqBody:{}};return this.api.npPost(`${this.npBasePath}/AA0704?before`,t)}updateAlertSetting(t){let r={ReqHeader:this.api.getReqHeader(n.Nx.updateAlertSetting),ReqBody:t};return this.api.npPost(`${this.npBasePath}/AA0704`,r)}deleteAlertSetting(t){let r={ReqHeader:this.api.getReqHeader(n.Nx.deleteAlert),ReqBody:t};return this.api.npPost(`${this.npBasePath}/AA0705`,r)}queryAlarmSettings_ignore1298(t){let r={ReqHeader:this.api.getReqHeader(n.Nx.queryAlarmSettings),ReqBody:t};return this.api.excuteNpPost_ignore1298(`${this.npBasePath}/AA0706`,r)}queryAlarmSettings(t){let r={ReqHeader:this.api.getReqHeader(n.Nx.queryAlarmSettings),ReqBody:t};return this.api.npPost(`${this.npBasePath}/AA0706`,r)}}return a.\u0275fac=function(t){return new(t||a)(c.LFG(v.K))},a.\u0275prov=c.Yz7({token:a,factory:a.\u0275fac}),a})()},78215:(R,y,o)=>{"use strict";o.d(y,{h:()=>g});var f=o(92340),n=o(57553),c=o(87587),v=o(30424);let g=(()=>{class a{constructor(t){this.api=t,this.api.baseUrl=f.N.dpPath}get basePath(){return f.N.isv4?"dgrv4/11":"tsmpdpaa/11"}signReq(t){let r={ReqHeader:this.api.getReqHeader(n.Nx.signReq),ReqBody:t};return this.api.npPost(`${this.basePath}/DPB0071`,r)}queryApiDpStatusLikeList_ignore1298(t){let r={ReqHeader:this.api.getReqHeader(n.Nx.queryApiDpStatusLikeList),ReqBody:t};return this.api.excuteNpPost_ignore1298(`${this.basePath}/DPB0072`,r)}queryApiDpStatusLikeList(t){let r={ReqHeader:this.api.getReqHeader(n.Nx.queryApiDpStatusLikeList),ReqBody:t};return this.api.npPost(`${this.basePath}/DPB0072`,r)}setApiPublicFlag(t){let r={ReqHeader:this.api.getReqHeader(n.Nx.setApiPublicFlag),ReqBody:t};return this.api.npPost(`${this.basePath}/DPB0073`,r)}}return a.\u0275fac=function(t){return new(t||a)(c.LFG(v.K))},a.\u0275prov=c.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},75809:(R,y,o)=>{"use strict";o.d(y,{A:()=>g});var f=o(92340),n=o(57553),c=o(87587),v=o(30424);let g=(()=>{class a{constructor(t){this.api=t,this.api.baseUrl=f.N.dpPath}get basePath(){return f.N.isv4?"dgrv4/11":"tsmpdpaa/11"}queryApiLov_ignore1298(t){let r={ReqHeader:this.api.getReqHeader(n.Nx.queryApiLov),ReqBody:t};return this.api.excuteNpPost_ignore1298(`${this.basePath}/DPB0075`,r)}queryApiLov(t){let r={ReqHeader:this.api.getReqHeader(n.Nx.queryApiLov),ReqBody:t};return this.api.npPost(`${this.basePath}/DPB0075`,r)}queryThemeLov_ignore1298(t){let r={ReqHeader:this.api.getReqHeader(n.Nx.queryThemeLov),ReqBody:t};return this.api.excuteNpPost_ignore1298(`${this.basePath}/DPB0076`,r)}queryThemeLov(t){let r={ReqHeader:this.api.getReqHeader(n.Nx.queryThemeLov),ReqBody:t};return this.api.npPost(`${this.basePath}/DPB0076`,r)}}return a.\u0275fac=function(t){return new(t||a)(c.LFG(v.K))},a.\u0275prov=c.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},51753:(R,y,o)=>{"use strict";o.d(y,{Y:()=>n});var f=o(87587);let n=(()=>{class c{constructor(){}navigateUrl(g){window.location.href=g}}return c.\u0275fac=function(g){return new(g||c)},c.\u0275prov=f.Yz7({token:c,factory:c.\u0275fac}),c})()},79581:(R,y,o)=>{"use strict";var n=o(8708);function c(r,e){return void 0===e&&(e="utf8"),Buffer.isBuffer(r)?a(r.toString("base64")):a(Buffer.from(r,e).toString("base64"))}function g(r){return r=r.toString(),n.default(r).replace(/\-/g,"+").replace(/_/g,"/")}function a(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}var t=c;t.encode=c,t.decode=function v(r,e){return void 0===e&&(e="utf8"),Buffer.from(g(r),"base64").toString(e)},t.toBase64=g,t.fromBase64=a,t.toBuffer=function _(r){return Buffer.from(g(r),"base64")},y.default=t},8708:(R,y)=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.default=function o(f){var c=f.length,v=c%4;if(!v)return f;var g=c,a=4-v,t=Buffer.alloc(c+a);for(t.write(f);a--;)t.write("=",g++);return t.toString()}},35117:(R,y,o)=>{R.exports=o(79581).default,R.exports.default=R.exports},94327:function(R,y){var n;void 0!==(n=function(){"use strict";function v(e,i,E){var l=new XMLHttpRequest;l.open("GET",e),l.responseType="blob",l.onload=function(){r(l.response,i,E)},l.onerror=function(){console.error("could not download file")},l.send()}function g(e){var i=new XMLHttpRequest;i.open("HEAD",e,!1);try{i.send()}catch(E){}return 200<=i.status&&299>=i.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(E){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(i)}}var _="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,t=_.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),r=_.saveAs||("object"!=typeof window||window!==_?function(){}:"download"in HTMLAnchorElement.prototype&&!t?function(e,i,E){var l=_.URL||_.webkitURL,h=document.createElement("a");h.download=i=i||e.name||"download",h.rel="noopener","string"==typeof e?(h.href=e,h.origin===location.origin?a(h):g(h.href)?v(e,i,E):a(h,h.target="_blank")):(h.href=l.createObjectURL(e),setTimeout(function(){l.revokeObjectURL(h.href)},4e4),setTimeout(function(){a(h)},0))}:"msSaveOrOpenBlob"in navigator?function(e,i,E){if(i=i||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function c(e,i){return void 0===i?i={autoBom:!1}:"object"!=typeof i&&(console.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,E),i);else if(g(e))v(e,i,E);else{var l=document.createElement("a");l.href=e,l.target="_blank",setTimeout(function(){a(l)})}}:function(e,i,E,l){if((l=l||open("","_blank"))&&(l.document.title=l.document.body.innerText="downloading..."),"string"==typeof e)return v(e,i,E);var h="application/octet-stream"===e.type,P=/constructor/i.test(_.HTMLElement)||_.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||h&&P||t)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var p=d.result;p=s?p:p.replace(/^data:[^;]*;/,"data:attachment/file;"),l?l.location.href=p:location=p,l=null},d.readAsDataURL(e)}else{var u=_.URL||_.webkitURL,m=u.createObjectURL(e);l?l.location=m:location.href=m,l=null,setTimeout(function(){u.revokeObjectURL(m)},4e4)}});_.saveAs=r.saveAs=r,R.exports=r}.apply(y,[]))&&(R.exports=n)}}]);