(self.webpackChunksrcAngular=self.webpackChunksrcAngular||[]).push([[8592],{58838:(P,y,o)=>{"use strict";o.d(y,{n:()=>d});var l=o(27896),s=o(92340),i=o(57553),h=o(95244),a=o(87587),u=o(22313),t=o(45682),r=o(40704),e=o(69808);function p(m,A){if(1&m&&a._UZ(0,"iframe",1),2&m){const n=a.oxw();a.Q6J("src",n.url,a.uOi)}}const E=o(35117);let d=(()=>{class m{constructor(n,_,f,g){this.sanitizer=n,this.util=_,this.tool=f,this.alertService=g,this.reportID="",this.url="",this.timeRange=i.tn.Today,this.showStatus=!1,this.msgListenterAdd=!1,this.processing=!1,this.messageHandler=this.createMessageHandler()}ngOnInit(){this.showStatus=!1,this.url=this.sanitizer.bypassSecurityTrustResourceUrl(""),this.search(),window.addEventListener("message",this.messageHandler)}ngOnDestroy(){window.removeEventListener("message",this.messageHandler)}createMessageHandler(){return n=>{var _,f,g,v;"frame"==(null===(_=n.data)||void 0===_?void 0:_.from)&&"token_expired"==(null===(f=n.data)||void 0===f?void 0:f.type)?this.processing||(this.processing=!0,this.util.queryReportUrls({reportID:this.reportID.toUpperCase(),timeRange:"T"}).subscribe(R=>{var D;this.processing=!1,this.tool.checkDpSuccess(R.ResHeader)&&(null===(D=document.getElementById("_frame").contentWindow)||void 0===D||D.postMessage({from:"dgr",type:"redo"},"*"))})):"frame"==(null===(g=n.data)||void 0===g?void 0:g.from)&&"reset_idle_time"==(null===(v=n.data)||void 0===v?void 0:v.type)&&this.tool.setExpiredTime()}}search(n=!1){let _=this.generateCAPI();this.timeRange&&this.util.queryReportUrls({reportID:this.reportID.toUpperCase(),timeRange:"T"}).subscribe(f=>{if(this.tool.checkDpSuccess(f.ResHeader)){if(this.showStatus=!0,n)return;let g="";g="localhost"==location.hostname||"127.0.0.1"==location.hostname?s.N.apiUrl:`${location.protocol}//${location.hostname}:${location.port}`;let v="";switch(f.RespBody.reportType){case"SYS_RPT":v=`${g}${f.RespBody.rpContentPath}/login?cuuid=${_.uuid}&capikey=${_.capi}&reportURL=${f.RespBody.reportUrl}&embed=true`,this.url=this.sanitizer.bypassSecurityTrustResourceUrl(v);break;case"IFRAME":v=s.N.production?`${location.protocol}//${location.hostname}:${location.port}${f.RespBody.reportUrl}`:`${s.N.cusHostName}${f.RespBody.reportUrl}`,this.url=this.sanitizer.bypassSecurityTrustResourceUrl(v);break;case"LINK":v=`${f.RespBody.reportUrl}`,window.open(v,"_blank");break;default:this.alertService.ok("reportType not found","")}}})}generate_uuid(){var n=Date.now();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(n+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(_){var f=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"===_?f:3&f|8).toString(16)})}generateCAPI(){let n=this.generate_uuid().toUpperCase(),_=this.encodeUUID(n);return"Error: Digest method not supported"===_&&(n="67C42D24-BCFD-40B1-99E9-C4CE4D9ADBCD",_="tflvB2FW3nhUIvF3PMHQxw"),{uuid:n,capi:_}}encodeUUID(n){if("string"!=typeof n||0===n.length)return"";const f=Uint8Array.of(128),g=new TextEncoder;try{let v=n.toLocaleUpperCase()+"TPIdigiRunner",R=g.encode(v),D=this.concatenate(Uint8Array,R,f),B=h("sha256").update(D).digest(),L=B.subarray(B.length/2,B.length);return E(L)}catch(v){return console.log("e",v),v}}concatenate(n,..._){let f=0;for(const R of _)f+=R.length;const g=new n(f);let v=0;for(const R of _)g.set(R,v),v+=R.length;return g}}return m.\u0275fac=function(n){return new(n||m)(a.Y36(u.H7),a.Y36(l.f),a.Y36(t.g),a.Y36(r.c))},m.\u0275cmp=a.Xpm({type:m,selectors:[["app-frame"]],inputs:{reportID:"reportID"},features:[a._Bn([l.f])],decls:1,vars:1,consts:[["id","_frame","title","","width","100%","height","100%","frameborder","0",3,"src",4,"ngIf"],["id","_frame","title","","width","100%","height","100%","frameborder","0",3,"src"]],template:function(n,_){1&n&&a.YNc(0,p,1,1,"iframe",0),2&n&&a.Q6J("ngIf",_.showStatus)},directives:[e.O5],styles:[""]}),m})()},58778:(P,y,o)=>{"use strict";o.d(y,{L:()=>h});var l=o(71764),i=o(87587);let h=(()=>{class c{transform(u,t){if(!u||20!=u.length)return;let e=u.substr(0,4),p=u.substr(4,2),E=u.substr(6,2),d=u.substr(9,2),m=u.substr(11,2),A=u.substr(13,2),n=u.slice(15);n=n.slice(0,3)+":"+n.slice(3);let _=l(`${e}-${p}-${E} ${d}:${m}:${A}`).toDate();return"time_ignore"===t?l(_).format("YYYY-MM-DD"):l(_).format("YYYY-MM-DD HH:mm:ss")}}return c.\u0275fac=function(u){return new(u||c)},c.\u0275pipe=i.Yjl({name:"datetime_format",type:c,pure:!0}),c})()},22751:(P,y,o)=>{"use strict";o.d(y,{Q:()=>s});var l=o(87587);let s=(()=>{class i{transform(c,a){return c?c.length>a?c.substring(0,a)+"...":c:""}}return i.\u0275fac=function(c){return new(c||i)},i.\u0275pipe=l.Yjl({name:"string_length",type:i,pure:!0}),i})()},78215:(P,y,o)=>{"use strict";o.d(y,{h:()=>c});var l=o(92340),s=o(57553),i=o(87587),h=o(96614);let c=(()=>{class a{constructor(t){this.api=t,this.api.baseUrl=l.N.dpPath}get basePath(){return l.N.isv4?"dgrv4/11":"tsmpdpaa/11"}signReq(t){let r={ReqHeader:this.api.getReqHeader(s.Nx.signReq),ReqBody:t};return this.api.npPost(`${this.basePath}/DPB0071`,r)}queryApiDpStatusLikeList_ignore1298(t){let r={ReqHeader:this.api.getReqHeader(s.Nx.queryApiDpStatusLikeList),ReqBody:t};return this.api.excuteNpPost_ignore1298(`${this.basePath}/DPB0072`,r)}queryApiDpStatusLikeList(t){let r={ReqHeader:this.api.getReqHeader(s.Nx.queryApiDpStatusLikeList),ReqBody:t};return this.api.npPost(`${this.basePath}/DPB0072`,r)}setApiPublicFlag(t){let r={ReqHeader:this.api.getReqHeader(s.Nx.setApiPublicFlag),ReqBody:t};return this.api.npPost(`${this.basePath}/DPB0073`,r)}}return a.\u0275fac=function(t){return new(t||a)(i.LFG(h.K))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},95536:(P,y,o)=>{"use strict";o.d(y,{B:()=>c});var l=o(92340),s=o(57553),i=o(87587),h=o(96614);let c=(()=>{class a{constructor(t){this.api=t}get npBasePath(){return l.N.isv4?"dgrv4/11":"tsmpdpaa/11"}queryTSecurityLV(t){let r={ReqHeader:this.api.getReqHeader(s.Nx.queryTSecurityLV),ReqBody:t};return this.api.npPost(`${this.npBasePath}/AA1102`,r)}addTGroupAuthority_before(){let t={ReqHeader:this.api.getReqHeader(s.Nx.addTGroupAuthority),ReqBody:{}};return this.api.npPost(`${this.npBasePath}/AA1106?before`,t)}addTGroupAuthority(t){let r={ReqHeader:this.api.getReqHeader(s.Nx.addTGroupAuthority),ReqBody:t};return this.api.npPost(`${this.npBasePath}/AA1106`,r)}updateTGroupAuthority_before(){let t={ReqHeader:this.api.getReqHeader(s.Nx.updateTGroupAuthority),ReqBody:{}};return this.api.npPost(`${this.npBasePath}/AA1108?before`,t)}updateTGroupAuthority(t){let r={ReqHeader:this.api.getReqHeader(s.Nx.updateTGroupAuthority),ReqBody:t};return this.api.npPost(`${this.npBasePath}/AA1108`,r)}queryTGroupAuthorityDetail(t){let r={ReqHeader:this.api.getReqHeader(s.Nx.queryTGroupAuthorityDetail),ReqBody:t};return this.api.npPost(`${this.npBasePath}/AA1109`,r)}deleteTGroupAuthority(t){let r={ReqHeader:this.api.getReqHeader(s.Nx.deleteTGroupAuthority),ReqBody:t};return this.api.npPost(`${this.npBasePath}/AA1110`,r)}queryScopeAuthorities_ignore1298(t){let r={ReqHeader:this.api.getReqHeader(s.Nx.queryScopeAuthorities),ReqBody:t};return this.api.excuteNpPost_ignore1298(`${this.npBasePath}/AA1115`,r)}queryScopeAuthorities(t){let r={ReqHeader:this.api.getReqHeader(s.Nx.queryScopeAuthorities),ReqBody:t};return this.api.npPost(`${this.npBasePath}/AA1115`,r)}}return a.\u0275fac=function(t){return new(t||a)(i.LFG(h.K))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},75809:(P,y,o)=>{"use strict";o.d(y,{A:()=>c});var l=o(92340),s=o(57553),i=o(87587),h=o(96614);let c=(()=>{class a{constructor(t){this.api=t,this.api.baseUrl=l.N.dpPath}get basePath(){return l.N.isv4?"dgrv4/11":"tsmpdpaa/11"}queryApiLov_ignore1298(t){let r={ReqHeader:this.api.getReqHeader(s.Nx.queryApiLov),ReqBody:t};return this.api.excuteNpPost_ignore1298(`${this.basePath}/DPB0075`,r)}queryApiLov(t){let r={ReqHeader:this.api.getReqHeader(s.Nx.queryApiLov),ReqBody:t};return this.api.npPost(`${this.basePath}/DPB0075`,r)}queryThemeLov_ignore1298(t){let r={ReqHeader:this.api.getReqHeader(s.Nx.queryThemeLov),ReqBody:t};return this.api.excuteNpPost_ignore1298(`${this.basePath}/DPB0076`,r)}queryThemeLov(t){let r={ReqHeader:this.api.getReqHeader(s.Nx.queryThemeLov),ReqBody:t};return this.api.npPost(`${this.basePath}/DPB0076`,r)}}return a.\u0275fac=function(t){return new(t||a)(i.LFG(h.K))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},51753:(P,y,o)=>{"use strict";o.d(y,{Y:()=>s});var l=o(87587);let s=(()=>{class i{constructor(){}navigateUrl(c){window.location.href=c}}return i.\u0275fac=function(c){return new(c||i)},i.\u0275prov=l.Yz7({token:i,factory:i.\u0275fac}),i})()},79581:(P,y,o)=>{"use strict";var s=o(8708);function i(r,e){return void 0===e&&(e="utf8"),Buffer.isBuffer(r)?a(r.toString("base64")):a(Buffer.from(r,e).toString("base64"))}function c(r){return r=r.toString(),s.default(r).replace(/\-/g,"+").replace(/_/g,"/")}function a(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}var t=i;t.encode=i,t.decode=function h(r,e){return void 0===e&&(e="utf8"),Buffer.from(c(r),"base64").toString(e)},t.toBase64=c,t.fromBase64=a,t.toBuffer=function u(r){return Buffer.from(c(r),"base64")},y.default=t},8708:(P,y)=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.default=function o(l){var i=l.length,h=i%4;if(!h)return l;var c=i,a=4-h,t=Buffer.alloc(i+a);for(t.write(l);a--;)t.write("=",c++);return t.toString()}},35117:(P,y,o)=>{P.exports=o(79581).default,P.exports.default=P.exports},94327:function(P,y){var s;void 0!==(s=function(){"use strict";function h(e,p,E){var d=new XMLHttpRequest;d.open("GET",e),d.responseType="blob",d.onload=function(){r(d.response,p,E)},d.onerror=function(){console.error("could not download file")},d.send()}function c(e){var p=new XMLHttpRequest;p.open("HEAD",e,!1);try{p.send()}catch(E){}return 200<=p.status&&299>=p.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(E){var p=document.createEvent("MouseEvents");p.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(p)}}var u="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,t=u.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),r=u.saveAs||("object"!=typeof window||window!==u?function(){}:"download"in HTMLAnchorElement.prototype&&!t?function(e,p,E){var d=u.URL||u.webkitURL,m=document.createElement("a");m.download=p=p||e.name||"download",m.rel="noopener","string"==typeof e?(m.href=e,m.origin===location.origin?a(m):c(m.href)?h(e,p,E):a(m,m.target="_blank")):(m.href=d.createObjectURL(e),setTimeout(function(){d.revokeObjectURL(m.href)},4e4),setTimeout(function(){a(m)},0))}:"msSaveOrOpenBlob"in navigator?function(e,p,E){if(p=p||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function i(e,p){return void 0===p?p={autoBom:!1}:"object"!=typeof p&&(console.warn("Deprecated: Expected third argument to be a object"),p={autoBom:!p}),p.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,E),p);else if(c(e))h(e,p,E);else{var d=document.createElement("a");d.href=e,d.target="_blank",setTimeout(function(){a(d)})}}:function(e,p,E,d){if((d=d||open("","_blank"))&&(d.document.title=d.document.body.innerText="downloading..."),"string"==typeof e)return h(e,p,E);var m="application/octet-stream"===e.type,A=/constructor/i.test(u.HTMLElement)||u.safari,n=/CriOS\/[\d]+/.test(navigator.userAgent);if((n||m&&A||t)&&"undefined"!=typeof FileReader){var _=new FileReader;_.onloadend=function(){var v=_.result;v=n?v:v.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=v:location=v,d=null},_.readAsDataURL(e)}else{var f=u.URL||u.webkitURL,g=f.createObjectURL(e);d?d.location=g:location.href=g,d=null,setTimeout(function(){f.revokeObjectURL(g)},4e4)}});u.saveAs=r.saveAs=r,P.exports=r}.apply(y,[]))&&(P.exports=s)}}]);