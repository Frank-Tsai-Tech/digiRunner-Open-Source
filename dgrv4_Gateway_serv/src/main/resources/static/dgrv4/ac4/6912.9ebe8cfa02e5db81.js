"use strict";(self.webpackChunksrcAngular=self.webpackChunksrcAngular||[]).push([[6912],{86912:(R,v,n)=>{n.r(v),n.d(v,{LdapModule:()=>F});var y=n(24783),l=n(93075),L=n(69808),g=n(92340),c=n(40520),f=n(68306),e=n(87587),Z=n(45682),A=n(40704),T=n(4924),b=n(27896),S=n(24300),h=n(99291),C=n(3937),x=n(55679),U=n(51062);const w=[{path:"",component:(()=>{class s{constructor(t,o,r,i,p,a,m,d,Y,I,J){this.fb=t,this.httpClient=o,this.toolService=r,this.alertService=i,this.signBlockService=p,this.util=a,this.userService=m,this.router=d,this.ngxService=Y,this.funcService=I,this.route=J,this.title="",this.imgSrc="",this.idpType="LDAP"}ngOnInit(){this.form=this.fb.group({uname:new l.NI(""),pwd:new l.NI("")}),this.route.queryParams.subscribe(t=>{t.type&&(this.idpType=t.type),this.getTitle(),this.getIcon()})}getTitle(){let t="";t="localhost"==location.hostname||"127.0.0.1"==location.hostname?g.N.apiUrl:`${location.protocol}//${location.hostname}:${location.port}`,t+=`/dgrv4/ssotoken/acidp/${this.idpType}/getTitle`;let o=new c.WM;this.httpClient.get(`${t}`,{headers:o,observe:"response",responseType:"text"}).subscribe(r=>{var i;this.title=null!==(i=r.body)&&void 0!==i?i:""})}getIcon(){let t="";t="localhost"==location.hostname||"127.0.0.1"==location.hostname?g.N.apiUrl:`${location.protocol}//${location.hostname}:${location.port}`,t+=`/dgrv4/ssotoken/acidp/${this.idpType}/getIcon`;let o=new c.WM;this.httpClient.get(`${t}`,{headers:o,observe:"response",responseType:"text"}).subscribe(r=>{var i;this.imgSrc=null!==(i=r.body)&&void 0!==i?i:""})}submitForm(){var t,o;let r=new URLSearchParams,i=new c.WM({"Content-Type":"application/x-www-form-urlencoded",digiRunner:"ldap process"});r.set("username",null===(t=this.uname)||void 0===t?void 0:t.value),r.set("password",null===(o=this.pwd)||void 0===o?void 0:o.value),this.httpClient.post(`${g.N.apiUrl}/dgrv4/ssotoken/acidp/${this.idpType}/acIdPLogin`,r,{headers:i,responseType:"text",observe:"response"}).subscribe(a=>{window.location.href=a.url})}setFuncList(){return new f.y(t=>{this.funcService.queryAllFunc().subscribe(o=>{this.toolService.checkDpSuccess(o.ResHeader)&&(this.toolService.setFuncList(o.RespBody.funcList),t.next(!0))})})}auth(t){let o=[];return new f.y(r=>{this.userService.queryFuncByLoginUser().subscribe(i=>{if(this.toolService.checkDpSuccess(i.ResHeader)){this.toolService.writeRoleFuncCodeList(i.RespBody.funcCodeList);for(let p=0;p<t.length;p++){const a=t[p];let m=i.RespBody.funcCodeList.findIndex(d=>d===a);o.findIndex(d=>d.funCode==a)<0?o.push({funCode:a,canExecute:m>=0}):m>=0&&(o[o.findIndex(d=>d.funCode==a)].canExecute=!0)}r.next(o)}})})}get uname(){return this.form.get("uname")}get pwd(){return this.form.get("pwd")}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(l.qu),e.Y36(c.eN),e.Y36(Z.g),e.Y36(A.c),e.Y36(T.T),e.Y36(b.f),e.Y36(S.K),e.Y36(h.F0),e.Y36(C.LA),e.Y36(x.B),e.Y36(h.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-ldap"]],decls:41,vars:27,consts:[[1,"login-center-page"],[1,"form-wrapper"],[3,"formGroup","ngSubmit"],[1,"form-header"],[2,"font-weight","bold"],[3,"src"],[1,"form-body"],[1,"line",3,"hidden"],[2,"font-size","small"],[1,"form-area"],[1,"input-line"],["for","uname"],[1,"input-sign-wrapper"],[1,"sign"],["src","assets/images/login/i_user.png","alt","number"],["type","text","formControlName","uname",1,"form-control",3,"placeholder"],["username",""],["src","assets/images/login/i_pwd.png","alt","number"],["type","password","formControlName","pwd",1,"form-control",3,"placeholder"],[1,"btn-row"],["type","submit",1,"btn","btn-login"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e.NdJ("ngSubmit",function(){return o.submitForm()}),e.TgZ(3,"div",3)(4,"h1",4),e._UZ(5,"img",5),e._uU(6),e.qZA()(),e._UZ(7,"hr"),e.TgZ(8,"div",6)(9,"div",7)(10,"p"),e._uU(11),e.ALo(12,"translate"),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"p",8),e._uU(15),e.ALo(16,"translate"),e.qZA()(),e.TgZ(17,"div",9)(18,"div",10)(19,"label",11),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"div",12)(23,"span",13),e._UZ(24,"img",14),e.qZA(),e._UZ(25,"input",15,16),e.ALo(27,"translate"),e.qZA()(),e.TgZ(28,"div",10)(29,"label",11),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"div",12)(33,"span",13),e._UZ(34,"img",17),e.qZA(),e._UZ(35,"input",18),e.ALo(36,"translate"),e.qZA()(),e.TgZ(37,"div",19)(38,"button",20),e._uU(39),e.ALo(40,"translate"),e.qZA()()()()()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("src",o.imgSrc,e.LSH),e.xp6(1),e.hij(" ",o.title," "),e.xp6(3),e.Q6J("hidden","API"==o.idpType),e.xp6(2),e.hij(" ","LDAP"==o.idpType?e.lcZ(12,11,"adldap_login"):e.lcZ(13,13,"m_adldap_login")," "),e.xp6(4),e.hij(" ",e.lcZ(16,15,"continue_proc")," "),e.xp6(5),e.Oqu(e.lcZ(21,17,"user_name")),e.xp6(5),e.Q6J("placeholder",e.lcZ(27,19,"user_name")),e.xp6(5),e.Oqu(e.lcZ(31,21,"user_password")),e.xp6(5),e.Q6J("placeholder",e.lcZ(36,23,"user_password")),e.xp6(4),e.hij(" ",e.lcZ(40,25,"login")," "))},directives:[l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u],pipes:[U.X$],styles:[""]}),s})()}];let $=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[h.Bz.forChild(w)],h.Bz]}),s})(),F=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[L.ez,l.u5,l.UX,y.m,$]]}),s})()}}]);