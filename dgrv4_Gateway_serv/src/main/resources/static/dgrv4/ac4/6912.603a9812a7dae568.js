"use strict";(self.webpackChunksrcAngular=self.webpackChunksrcAngular||[]).push([[6912],{86912:(M,g,s)=>{s.r(g),s.d(g,{LdapModule:()=>B});var L=s(24783),a=s(93075),Z=s(69808),f=s(51753),v=s(92340),m=s(40520),y=s(68306),e=s(87587),A=s(45682),S=s(40704),T=s(4924),b=s(27896),C=s(24300),h=s(99291),U=s(3937),x=s(55679),Y=s(51062);const $=[{path:"",component:(()=>{class n{constructor(t,o,r,i,p,l,u,c,I,J,R,j){this.fb=t,this.httpClient=o,this.toolService=r,this.alertService=i,this.signBlockService=p,this.util=l,this.userService=u,this.router=c,this.ngxService=I,this.funcService=J,this.route=R,this.sanitizerService=j,this.title="",this.imgSrc="",this.idpType="LDAP"}ngOnInit(){this.form=this.fb.group({uname:new a.NI(""),mima:new a.NI("")}),this.route.queryParams.subscribe(t=>{t.type&&(this.idpType=t.type),this.getTitle(),this.getIcon()})}getTitle(){let t="";t="localhost"==location.hostname||"127.0.0.1"==location.hostname?v.N.apiUrl:`${location.protocol}//${location.hostname}:${location.port}`,t+=`/dgrv4/ssotoken/acidp/${this.idpType}/getTitle`;let o=new m.WM;this.httpClient.get(`${t}`,{headers:o,observe:"response",responseType:"text"}).subscribe(r=>{var i;this.title=null!==(i=r.body)&&void 0!==i?i:""})}getIcon(){let t="";t="localhost"==location.hostname||"127.0.0.1"==location.hostname?v.N.apiUrl:`${location.protocol}//${location.hostname}:${location.port}`,t+=`/dgrv4/ssotoken/acidp/${this.idpType}/getIcon`;let o=new m.WM;this.httpClient.get(`${t}`,{headers:o,observe:"response",responseType:"text"}).subscribe(r=>{var i;this.imgSrc=null!==(i=r.body)&&void 0!==i?i:""})}submitForm(){var t,o;let r=new URLSearchParams,i=new m.WM({"Content-Type":"application/x-www-form-urlencoded",digiRunner:"ldap process"});r.set(["us","ern","ame"].join(""),null===(t=this.uname)||void 0===t?void 0:t.value),r.set(["p","ass","word"].join(""),null===(o=this.mima)||void 0===o?void 0:o.value),this.httpClient.post(`${v.N.apiUrl}/dgrv4/ssotoken/acidp/${this.idpType}/acIdPLogin`,r,{headers:i,responseType:"text",observe:"response"}).subscribe(u=>{this.sanitizerService.navigateUrl(u.url)})}setFuncList(){return new y.y(t=>{this.funcService.queryAllFunc().subscribe(o=>{this.toolService.checkDpSuccess(o.ResHeader)&&(this.toolService.setFuncList(o.RespBody.funcList),t.next(!0))})})}auth(t){let o=[];return new y.y(r=>{this.userService.queryFuncByLoginUser().subscribe(i=>{if(this.toolService.checkDpSuccess(i.ResHeader)){this.toolService.writeRoleFuncCodeList(i.RespBody.funcCodeList);for(let p=0;p<t.length;p++){const l=t[p];let u=i.RespBody.funcCodeList.findIndex(c=>c===l);o.findIndex(c=>c.funCode==l)<0?o.push({funCode:l,canExecute:u>=0}):u>=0&&(o[o.findIndex(c=>c.funCode==l)].canExecute=!0)}r.next(o)}})})}get uname(){return this.form.get("uname")}get mima(){return this.form.get("mima")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(a.qu),e.Y36(m.eN),e.Y36(A.g),e.Y36(S.c),e.Y36(T.T),e.Y36(b.f),e.Y36(C.K),e.Y36(h.F0),e.Y36(U.LA),e.Y36(x.B),e.Y36(h.gz),e.Y36(f.Y))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-ldap"]],features:[e._Bn([f.Y])],decls:41,vars:27,consts:[[1,"login-center-page"],[1,"form-wrapper"],[3,"formGroup","ngSubmit"],[1,"form-header"],[2,"font-weight","bold"],[3,"src"],[1,"form-body"],[1,"line",3,"hidden"],[2,"font-size","small"],[1,"form-area"],[1,"input-line"],["for","uname"],[1,"input-sign-wrapper"],[1,"sign"],["src","assets/images/login/i_user.png","alt","number"],["type","text","formControlName","uname",1,"form-control",3,"placeholder"],["username",""],["src","assets/images/login/i_pwd.png","alt","number"],["type","password","formControlName","mima",1,"form-control",3,"placeholder"],[1,"btn-row"],["type","submit",1,"btn","btn-login"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e.NdJ("ngSubmit",function(){return o.submitForm()}),e.TgZ(3,"div",3)(4,"h1",4),e._UZ(5,"img",5),e._uU(6),e.qZA()(),e._UZ(7,"hr"),e.TgZ(8,"div",6)(9,"div",7)(10,"p"),e._uU(11),e.ALo(12,"translate"),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"p",8),e._uU(15),e.ALo(16,"translate"),e.qZA()(),e.TgZ(17,"div",9)(18,"div",10)(19,"label",11),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"div",12)(23,"span",13),e._UZ(24,"img",14),e.qZA(),e._UZ(25,"input",15,16),e.ALo(27,"translate"),e.qZA()(),e.TgZ(28,"div",10)(29,"label",11),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"div",12)(33,"span",13),e._UZ(34,"img",17),e.qZA(),e._UZ(35,"input",18),e.ALo(36,"translate"),e.qZA()(),e.TgZ(37,"div",19)(38,"button",20),e._uU(39),e.ALo(40,"translate"),e.qZA()()()()()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("src",o.imgSrc,e.LSH),e.xp6(1),e.hij(" ",o.title," "),e.xp6(3),e.Q6J("hidden","API"==o.idpType),e.xp6(2),e.hij(" ","LDAP"==o.idpType?e.lcZ(12,11,"adldap_login"):e.lcZ(13,13,"m_adldap_login")," "),e.xp6(4),e.hij(" ",e.lcZ(16,15,"continue_proc")," "),e.xp6(5),e.Oqu(e.lcZ(21,17,"user_name")),e.xp6(5),e.Q6J("placeholder",e.lcZ(27,19,"user_name")),e.xp6(5),e.Oqu(e.lcZ(31,21,"user_password")),e.xp6(5),e.Q6J("placeholder",e.lcZ(36,23,"user_password")),e.xp6(4),e.hij(" ",e.lcZ(40,25,"login")," "))},directives:[a._Y,a.JL,a.sg,a.Fj,a.JJ,a.u],pipes:[Y.X$],styles:[""]}),n})()}];let F=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[h.Bz.forChild($)],h.Bz]}),n})(),B=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[Z.ez,a.u5,a.UX,L.m,F]]}),n})()}}]);